import nodemailer from "nodemailer";
import { BookingRequest } from "./google-calendar";

// Configurare transporter pentru email
const transporter = nodemailer.createTransport({
  service: "gmail", // sau alt serviciu de email
  auth: {
    user: process.env.EMAIL_USER,
    pass: process.env.EMAIL_PASSWORD, // Parola de aplica»õie pentru Gmail
  },
});

export interface EmailNotification {
  to: string;
  subject: string;
  html: string;
}

// Template pentru email de confirmare programare
export function createBookingConfirmationEmail(
  booking: BookingRequest,
  bookingId: string
): EmailNotification {
  const formattedDate = new Date(
    `${booking.date}T${booking.time}:00`
  ).toLocaleDateString("ro-RO", {
    weekday: "long",
    year: "numeric",
    month: "long",
    day: "numeric",
    hour: "2-digit",
    minute: "2-digit",
  });

  return {
    to: booking.email!,
    subject: "Confirmare Programare - Barber Shop",
    html: `
      <!DOCTYPE html>
      <html>
      <head>
        <meta charset="utf-8">
        <style>
          body { font-family: Arial, sans-serif; line-height: 1.6; color: #333; }
          .container { max-width: 600px; margin: 0 auto; padding: 20px; }
          .header { background: #1f2937; color: white; padding: 20px; text-align: center; }
          .content { padding: 20px; background: #f9fafb; }
          .booking-details { background: white; padding: 20px; margin: 20px 0; border-radius: 8px; }
          .button { display: inline-block; padding: 12px 24px; background: #3b82f6; color: white; text-decoration: none; border-radius: 6px; margin: 10px 5px; }
          .button.cancel { background: #ef4444; }
          .footer { text-align: center; padding: 20px; color: #6b7280; font-size: 14px; }
        </style>
      </head>
      <body>
        <div class="container">
          <div class="header">
            <h1>‚úÇÔ∏è Barber Shop</h1>
            <p>Confirmare Programare</p>
          </div>
          
          <div class="content">
            <h2>Salut ${booking.name}!</h2>
            <p>Programarea ta a fost confirmatƒÉ cu succes.</p>
            
            <div class="booking-details">
              <h3>üìÖ Detalii Programare</h3>
              <p><strong>Data »ôi ora:</strong> ${formattedDate}</p>
              <p><strong>Serviciu:</strong> ${booking.service}</p>
              <p><strong>Telefon:</strong> ${booking.phone}</p>
              ${
                booking.notes
                  ? `<p><strong>Note:</strong> ${booking.notes}</p>`
                  : ""
              }
              <p><strong>ID Programare:</strong> ${bookingId}</p>
            </div>
            
            <p>Pentru a modifica sau anula programarea, folose»ôte butoanele de mai jos:</p>
            
                         <div style="text-align: center;">
               <a href="${
                 process.env.NEXT_PUBLIC_BASE_URL || "http://localhost:3000"
               }/booking/modify/${bookingId}" class="button">
                 ‚úèÔ∏è ModificƒÉ Programarea
               </a>
               <a href="${
                 process.env.NEXT_PUBLIC_BASE_URL || "http://localhost:3000"
               }/booking/cancel/${bookingId}" class="button cancel">
                 ‚ùå AnuleazƒÉ Programarea
               </a>
             </div>
            
            <div style="margin-top: 30px; padding: 15px; background: #fef3c7; border-radius: 6px;">
              <p><strong>‚ö†Ô∏è Important:</strong></p>
              <ul>
                <li>Te rugƒÉm sƒÉ vii cu 5 minute √Ænainte de programare</li>
                <li>Pentru anulare, contacteazƒÉ-ne cu cel pu»õin 2 ore √Ænainte</li>
                <li>√én caz de √Ænt√¢rziere, programarea poate fi reprogramatƒÉ</li>
              </ul>
            </div>
          </div>
          
          <div class="footer">
            <p>Barber Shop - ProgramƒÉri Online</p>
            <p>Pentru √ÆntrebƒÉri: ${
              process.env.CONTACT_EMAIL || "contact@barbershop.com"
            }</p>
          </div>
        </div>
      </body>
      </html>
    `,
  };
}

// Template pentru email de notificare pentru barber
export function createBarberNotificationEmail(
  booking: BookingRequest,
  bookingId: string
): EmailNotification {
  const formattedDate = new Date(
    `${booking.date}T${booking.time}:00`
  ).toLocaleDateString("ro-RO", {
    weekday: "long",
    year: "numeric",
    month: "long",
    day: "numeric",
    hour: "2-digit",
    minute: "2-digit",
  });

  return {
    to: process.env.BARBER_EMAIL || "barber@barbershop.com",
    subject: `NouƒÉ Programare - ${booking.name}`,
    html: `
      <!DOCTYPE html>
      <html>
      <head>
        <meta charset="utf-8">
        <style>
          body { font-family: Arial, sans-serif; line-height: 1.6; color: #333; }
          .container { max-width: 600px; margin: 0 auto; padding: 20px; }
          .header { background: #059669; color: white; padding: 20px; text-align: center; }
          .content { padding: 20px; background: #f9fafb; }
          .booking-details { background: white; padding: 20px; margin: 20px 0; border-radius: 8px; }
          .button { display: inline-block; padding: 12px 24px; background: #3b82f6; color: white; text-decoration: none; border-radius: 6px; margin: 10px 5px; }
          .footer { text-align: center; padding: 20px; color: #6b7280; font-size: 14px; }
        </style>
      </head>
      <body>
        <div class="container">
          <div class="header">
            <h1>‚úÇÔ∏è NouƒÉ Programare</h1>
            <p>Client: ${booking.name}</p>
          </div>
          
          <div class="content">
            <h2>Detalii Programare</h2>
            
            <div class="booking-details">
              <p><strong>üìÖ Data »ôi ora:</strong> ${formattedDate}</p>
              <p><strong>üë§ Client:</strong> ${booking.name}</p>
              <p><strong>üìû Telefon:</strong> ${booking.phone}</p>
              <p><strong>üìß Email:</strong> ${booking.email || "N/A"}</p>
              <p><strong>‚úÇÔ∏è Serviciu:</strong> ${booking.service}</p>
              ${
                booking.notes
                  ? `<p><strong>üìù Note:</strong> ${booking.notes}</p>`
                  : ""
              }
              <p><strong>üÜî ID Programare:</strong> ${bookingId}</p>
            </div>
            
                         <div style="text-align: center;">
               <a href="${
                 process.env.NEXT_PUBLIC_BASE_URL || "http://localhost:3000"
               }/admin/bookings" class="button">
                 üë®‚Äçüíº Vezi Toate ProgramƒÉrile
               </a>
             </div>
          </div>
          
          <div class="footer">
            <p>Barber Shop - Sistem de ProgramƒÉri</p>
          </div>
        </div>
      </body>
      </html>
    `,
  };
}

// Template pentru email de anulare programare
export function createBookingCancellationEmail(
  booking: BookingRequest,
  bookingId: string
): EmailNotification {
  const formattedDate = new Date(
    `${booking.date}T${booking.time}:00`
  ).toLocaleDateString("ro-RO", {
    weekday: "long",
    year: "numeric",
    month: "long",
    day: "numeric",
    hour: "2-digit",
    minute: "2-digit",
  });

  return {
    to: booking.email!,
    subject: "Programare AnulatƒÉ - Barber Shop",
    html: `
      <!DOCTYPE html>
      <html>
      <head>
        <meta charset="utf-8">
        <style>
          body { font-family: Arial, sans-serif; line-height: 1.6; color: #333; }
          .container { max-width: 600px; margin: 0 auto; padding: 20px; }
          .header { background: #dc2626; color: white; padding: 20px; text-align: center; }
          .content { padding: 20px; background: #f9fafb; }
          .booking-details { background: white; padding: 20px; margin: 20px 0; border-radius: 8px; }
          .button { display: inline-block; padding: 12px 24px; background: #3b82f6; color: white; text-decoration: none; border-radius: 6px; margin: 10px 5px; }
          .footer { text-align: center; padding: 20px; color: #6b7280; font-size: 14px; }
        </style>
      </head>
      <body>
        <div class="container">
          <div class="header">
            <h1>‚úÇÔ∏è Barber Shop</h1>
            <p>Programare AnulatƒÉ</p>
          </div>
          
          <div class="content">
            <h2>Salut ${booking.name}!</h2>
            <p>Programarea ta a fost anulatƒÉ cu succes.</p>
            
            <div class="booking-details">
              <h3>üìÖ Programare AnulatƒÉ</h3>
              <p><strong>Data »ôi ora:</strong> ${formattedDate}</p>
              <p><strong>Serviciu:</strong> ${booking.service}</p>
              <p><strong>ID Programare:</strong> ${bookingId}</p>
            </div>
            
            <p>DacƒÉ dore»ôti sƒÉ faci o nouƒÉ programare, folose»ôte butonul de mai jos:</p>
            
            <div style="text-align: center;">
              <a href="${
                process.env.NEXT_PUBLIC_BASE_URL || "http://localhost:3000"
              }/booking" class="button">
                üìÖ ProgrameazƒÉ Din Nou
              </a>
            </div>
            
            <div style="margin-top: 30px; padding: 15px; background: #fef3c7; border-radius: 6px;">
              <p><strong>üí° Sfaturi:</strong></p>
              <ul>
                <li>Po»õi face o nouƒÉ programare oric√¢nd</li>
                <li>Pentru programƒÉri urgente, contacteazƒÉ-ne telefonic</li>
                <li>Mul»õumim pentru √Æn»õelegere!</li>
              </ul>
            </div>
          </div>
          
          <div class="footer">
            <p>Barber Shop - ProgramƒÉri Online</p>
            <p>Pentru √ÆntrebƒÉri: ${
              process.env.CONTACT_EMAIL || "contact@barbershop.com"
            }</p>
          </div>
        </div>
      </body>
      </html>
    `,
  };
}

// Func»õie pentru crearea email-ului de aprobare
function createBookingApprovalEmail(
  booking: BookingRequest,
  bookingId: string
): EmailNotification {
  const formattedDate = new Date(
    `${booking.date}T${booking.time}:00`
  ).toLocaleDateString("ro-RO", {
    day: "numeric",
    month: "long",
    year: "numeric",
    hour: "2-digit",
    minute: "2-digit",
  });

  return {
    to: booking.email!,
    subject: "‚úÖ Programarea ta a fost aprobatƒÉ!",
    html: `
      <!DOCTYPE html>
      <html>
      <head>
        <meta charset="utf-8">
        <style>
          .container { max-width: 600px; margin: 0 auto; padding: 20px; }
          .header { background: #10b981; color: white; padding: 20px; text-align: center; }
          .content { padding: 20px; background: #f9fafb; }
          .booking-details { background: white; padding: 20px; margin: 20px 0; border-radius: 8px; }
          .button { display: inline-block; padding: 12px 24px; background: #3b82f6; color: white; text-decoration: none; border-radius: 6px; margin: 10px 5px; }
          .footer { text-align: center; padding: 20px; color: #6b7280; font-size: 14px; }
        </style>
      </head>
      <body>
        <div class="container">
          <div class="header">
            <h1>‚úÇÔ∏è Barber Shop</h1>
            <p>Programare AprobatƒÉ!</p>
          </div>
          
          <div class="content">
            <h2>Salut ${booking.name}!</h2>
            <p>Programarea ta a fost aprobatƒÉ de frizer! üéâ</p>
            
            <div class="booking-details">
              <h3>üìÖ Detalii Programare</h3>
              <p><strong>Data »ôi ora:</strong> ${formattedDate}</p>
              <p><strong>Serviciu:</strong> ${booking.service}</p>
              <p><strong>ID Programare:</strong> ${bookingId}</p>
            </div>
            
            <div style="margin-top: 30px; padding: 15px; background: #d1fae5; border-radius: 6px;">
              <p><strong>‚úÖ Programarea ta este confirmatƒÉ!</strong></p>
              <p>Te a»ôteptƒÉm la programarea stabilitƒÉ. Pentru modificƒÉri, contacteazƒÉ-ne telefonic.</p>
            </div>
          </div>
          
          <div class="footer">
            <p>Barber Shop - ProgramƒÉri Online</p>
            <p>Pentru √ÆntrebƒÉri: ${
              process.env.CONTACT_EMAIL || "contact@barbershop.com"
            }</p>
          </div>
        </div>
      </body>
      </html>
    `,
  };
}

// Func»õie pentru crearea email-ului de respingere
function createBookingRejectionEmail(
  booking: BookingRequest,
  bookingId: string,
  reason: string
): EmailNotification {
  const formattedDate = new Date(
    `${booking.date}T${booking.time}:00`
  ).toLocaleDateString("ro-RO", {
    day: "numeric",
    month: "long",
    year: "numeric",
    hour: "2-digit",
    minute: "2-digit",
  });

  return {
    to: booking.email!,
    subject: "‚ùå Programarea ta a fost respinsƒÉ",
    html: `
      <!DOCTYPE html>
      <html>
      <head>
        <meta charset="utf-8">
        <style>
          .container { max-width: 600px; margin: 0 auto; padding: 20px; }
          .header { background: #dc2626; color: white; padding: 20px; text-align: center; }
          .content { padding: 20px; background: #f9fafb; }
          .booking-details { background: white; padding: 20px; margin: 20px 0; border-radius: 8px; }
          .button { display: inline-block; padding: 12px 24px; background: #3b82f6; color: white; text-decoration: none; border-radius: 6px; margin: 10px 5px; }
          .footer { text-align: center; padding: 20px; color: #6b7280; font-size: 14px; }
        </style>
      </head>
      <body>
        <div class="container">
          <div class="header">
            <h1>‚úÇÔ∏è Barber Shop</h1>
            <p>Programare RespinsƒÉ</p>
          </div>
          
          <div class="content">
            <h2>Salut ${booking.name}!</h2>
            <p>Ne pare rƒÉu, dar programarea ta a fost respinsƒÉ.</p>
            
            <div class="booking-details">
              <h3>üìÖ Programare RespinsƒÉ</h3>
              <p><strong>Data »ôi ora:</strong> ${formattedDate}</p>
              <p><strong>Serviciu:</strong> ${booking.service}</p>
              <p><strong>ID Programare:</strong> ${bookingId}</p>
              <p><strong>Motiv:</strong> ${reason}</p>
            </div>
            
            <p>Po»õi face o nouƒÉ programare folosind butonul de mai jos:</p>
            
            <div style="text-align: center;">
              <a href="${
                process.env.NEXT_PUBLIC_BASE_URL || "http://localhost:3000"
              }/booking" class="button">
                üìÖ ProgrameazƒÉ Din Nou
              </a>
            </div>
          </div>
          
          <div class="footer">
            <p>Barber Shop - ProgramƒÉri Online</p>
            <p>Pentru √ÆntrebƒÉri: ${
              process.env.CONTACT_EMAIL || "contact@barbershop.com"
            }</p>
          </div>
        </div>
      </body>
      </html>
    `,
  };
}

// Func»õie pentru crearea email-ului de reprogramare
function createBookingRescheduleEmail(
  booking: BookingRequest,
  bookingId: string,
  newDate: string,
  newTime: string,
  reason: string
): EmailNotification {
  const originalDate = new Date(
    `${booking.date}T${booking.time}:00`
  ).toLocaleDateString("ro-RO", {
    day: "numeric",
    month: "long",
    year: "numeric",
    hour: "2-digit",
    minute: "2-digit",
  });

  const newFormattedDate = new Date(
    `${newDate}T${newTime}:00`
  ).toLocaleDateString("ro-RO", {
    day: "numeric",
    month: "long",
    year: "numeric",
    hour: "2-digit",
    minute: "2-digit",
  });

  return {
    to: booking.email!,
    subject: "üîÑ Programarea ta a fost reprogramatƒÉ",
    html: `
      <!DOCTYPE html>
      <html>
      <head>
        <meta charset="utf-8">
        <style>
          .container { max-width: 600px; margin: 0 auto; padding: 20px; }
          .header { background: #3b82f6; color: white; padding: 20px; text-align: center; }
          .content { padding: 20px; background: #f9fafb; }
          .booking-details { background: white; padding: 20px; margin: 20px 0; border-radius: 8px; }
          .button { display: inline-block; padding: 12px 24px; background: #3b82f6; color: white; text-decoration: none; border-radius: 6px; margin: 10px 5px; }
          .footer { text-align: center; padding: 20px; color: #6b7280; font-size: 14px; }
        </style>
      </head>
      <body>
        <div class="container">
          <div class="header">
            <h1>‚úÇÔ∏è Barber Shop</h1>
            <p>Programare ReprogramatƒÉ</p>
          </div>
          
          <div class="content">
            <h2>Salut ${booking.name}!</h2>
            <p>Programarea ta a fost reprogramatƒÉ de frizer.</p>
            
            <div class="booking-details">
              <h3>üìÖ Detalii Reprogramare</h3>
              <p><strong>Data »ôi ora originalƒÉ:</strong> ${originalDate}</p>
              <p><strong>Noua datƒÉ »ôi orƒÉ:</strong> ${newFormattedDate}</p>
              <p><strong>Serviciu:</strong> ${booking.service}</p>
              <p><strong>ID Programare:</strong> ${bookingId}</p>
              <p><strong>Motiv:</strong> ${reason}</p>
            </div>
            
            <div style="margin-top: 30px; padding: 15px; background: #dbeafe; border-radius: 6px;">
              <p><strong>üîÑ Programarea ta a fost reprogramatƒÉ!</strong></p>
              <p>Te a»ôteptƒÉm la noua datƒÉ stabilitƒÉ. Pentru modificƒÉri, contacteazƒÉ-ne telefonic.</p>
            </div>
          </div>
          
          <div class="footer">
            <p>Barber Shop - ProgramƒÉri Online</p>
            <p>Pentru √ÆntrebƒÉri: ${
              process.env.CONTACT_EMAIL || "contact@barbershop.com"
            }</p>
          </div>
        </div>
      </body>
      </html>
    `,
  };
}

// Func»õie pentru crearea email-ului de confirmare modificare programare
export function createBookingModificationEmail(
  booking: BookingRequest,
  bookingId: string,
  oldDate: string,
  oldTime: string,
  newDate: string,
  newTime: string
): EmailNotification {
  const oldFormattedDate = new Date(
    `${oldDate}T${oldTime}:00`
  ).toLocaleDateString("ro-RO", {
    day: "numeric",
    month: "long",
    year: "numeric",
    hour: "2-digit",
    minute: "2-digit",
  });

  const newFormattedDate = new Date(
    `${newDate}T${newTime}:00`
  ).toLocaleDateString("ro-RO", {
    day: "numeric",
    month: "long",
    year: "numeric",
    hour: "2-digit",
    minute: "2-digit",
  });

  return {
    to: booking.email!,
    subject: "üîÑ Confirmare Modificare Programare - Barber Shop",
    html: `
      <!DOCTYPE html>
      <html>
      <head>
        <meta charset="utf-8">
        <style>
          body { font-family: Arial, sans-serif; line-height: 1.6; color: #333; }
          .container { max-width: 600px; margin: 0 auto; padding: 20px; }
          .header { background: #1f2937; color: white; padding: 20px; text-align: center; }
          .content { padding: 20px; background: #f9fafb; }
          .booking-details { background: white; padding: 20px; margin: 20px 0; border-radius: 8px; }
          .button { display: inline-block; padding: 12px 24px; background: #3b82f6; color: white; text-decoration: none; border-radius: 6px; margin: 10px 5px; }
          .button.confirm { background: #10b981; }
          .button.reject { background: #ef4444; }
          .footer { text-align: center; padding: 20px; color: #6b7280; font-size: 14px; }
          .warning { background: #fef3c7; border: 1px solid #f59e0b; padding: 15px; border-radius: 6px; margin: 20px 0; }
        </style>
      </head>
      <body>
        <div class="container">
          <div class="header">
            <h1>‚úÇÔ∏è Barber Shop</h1>
            <p>Confirmare Modificare Programare</p>
          </div>
          
          <div class="content">
            <h2>Salut ${booking.name}!</h2>
            <p>Frizerul a propus o modificare a programƒÉrii tale. Te rugƒÉm sƒÉ confirmi sau sƒÉ respingi aceastƒÉ modificare.</p>
            
            <div class="booking-details">
              <h3>üìÖ Detalii Modificare</h3>
              <p><strong>Data »ôi ora originalƒÉ:</strong> ${oldFormattedDate}</p>
              <p><strong>Noua datƒÉ »ôi orƒÉ propusƒÉ:</strong> ${newFormattedDate}</p>
              <p><strong>Serviciu:</strong> ${booking.service}</p>
              <p><strong>Telefon:</strong> ${booking.phone}</p>
              ${
                booking.notes
                  ? `<p><strong>Note:</strong> ${booking.notes}</p>`
                  : ""
              }
              <p><strong>ID Programare:</strong> ${bookingId}</p>
            </div>
            
            <div class="warning">
              <p><strong>‚ö†Ô∏è Important:</strong></p>
              <p>Programarea va fi modificatƒÉ doar dupƒÉ confirmarea ta. DacƒÉ nu confirmi √Æn urmƒÉtoarele 24 de ore, programarea va rƒÉm√¢ne la data »ôi ora originalƒÉ.</p>
            </div>
            
                         <div style="text-align: center;">
               <a href="${
                 process.env.NEXT_PUBLIC_BASE_URL || "http://localhost:3000"
               }/api/bookings/${bookingId}/confirm-modification?date=${newDate}&time=${newTime}" class="button confirm">
                 ‚úÖ ConfirmƒÉ Modificarea
               </a>
               <a href="${
                 process.env.NEXT_PUBLIC_BASE_URL || "http://localhost:3000"
               }/api/bookings/${bookingId}/reject-modification" class="button reject">
                 ‚ùå Respinge Modificarea
               </a>
             </div>
            
            <div style="margin-top: 30px; padding: 15px; background: #dbeafe; border-radius: 6px;">
              <p><strong>üìû Pentru √ÆntrebƒÉri:</strong></p>
              <p>DacƒÉ ai √ÆntrebƒÉri despre aceastƒÉ modificare, nu ezita sƒÉ ne contactezi telefonic.</p>
            </div>
          </div>
          
          <div class="footer">
            <p>Barber Shop - ProgramƒÉri Online</p>
            <p>Pentru √ÆntrebƒÉri: ${
              process.env.CONTACT_EMAIL || "contact@barbershop.com"
            }</p>
          </div>
        </div>
      </body>
      </html>
    `,
  };
}

// Func»õie pentru trimiterea email-ului
export async function sendEmail(
  notification: EmailNotification
): Promise<boolean> {
  try {
    const mailOptions = {
      from: process.env.EMAIL_USER,
      to: notification.to,
      subject: notification.subject,
      html: notification.html,
    };

    await transporter.sendMail(mailOptions);
    return true;
  } catch (error) {
    console.error("Eroare la trimiterea email-ului:", error);
    return false;
  }
}

// Func»õie pentru trimiterea notificƒÉrilor pentru o programare
export async function sendBookingNotifications(
  booking: BookingRequest,
  bookingId: string
): Promise<void> {
  try {
    // Trimite email de confirmare cƒÉtre client (obligatoriu acum)
    if (booking.email) {
      const clientEmail = createBookingConfirmationEmail(booking, bookingId);
      await sendEmail(clientEmail);
    }
  } catch (error) {
    console.error("Eroare la trimiterea notificƒÉrilor:", error);
  }
}

// Func»õie pentru trimiterea email-ului de aprobare cƒÉtre client
export async function sendBookingApprovalEmail(
  booking: BookingRequest,
  bookingId: string
): Promise<void> {
  try {
    if (booking.email) {
      const emailContent = createBookingApprovalEmail(booking, bookingId);
      await sendEmail(emailContent);
    }
  } catch (error) {
    console.error("Eroare la trimiterea email-ului de aprobare:", error);
  }
}

// Func»õie pentru trimiterea email-ului de respingere cƒÉtre client
export async function sendBookingRejectionEmail(
  booking: BookingRequest,
  bookingId: string,
  reason: string
): Promise<void> {
  try {
    if (booking.email) {
      const emailContent = createBookingRejectionEmail(
        booking,
        bookingId,
        reason
      );
      await sendEmail(emailContent);
    }
  } catch (error) {
    console.error("Eroare la trimiterea email-ului de respingere:", error);
  }
}

// Func»õie pentru trimiterea email-ului de reprogramare cƒÉtre client
export async function sendBookingRescheduleEmail(
  booking: BookingRequest,
  bookingId: string,
  newDate: string,
  newTime: string,
  reason: string
): Promise<void> {
  try {
    if (booking.email) {
      const emailContent = createBookingRescheduleEmail(
        booking,
        bookingId,
        newDate,
        newTime,
        reason
      );
      await sendEmail(emailContent);
    }
  } catch (error) {
    console.error("Eroare la trimiterea email-ului de reprogramare:", error);
  }
}

// Func»õie pentru trimiterea email-ului de confirmare modificare
export async function sendBookingModificationEmail(
  booking: BookingRequest,
  bookingId: string,
  oldDate: string,
  oldTime: string,
  newDate: string,
  newTime: string
): Promise<void> {
  try {
    if (booking.email) {
      const emailContent = createBookingModificationEmail(
        booking,
        bookingId,
        oldDate,
        oldTime,
        newDate,
        newTime
      );
      await sendEmail(emailContent);
    }
  } catch (error) {
    console.error(
      "‚ùå Eroare la trimiterea email-ului de confirmare modificare:",
      error
    );
  }
}

export async function sendBookingCancellationEmail(
  booking: {
    name: string;
    phone: string;
    email?: string;
    service: string;
    date: string;
    time: string;
    notes?: string;
  },
  bookingId: string,
  reason?: string
) {
  try {
    const transporter = nodemailer.createTransport({
      service: "gmail",
      auth: {
        user: process.env.EMAIL_USER,
        pass: process.env.EMAIL_PASSWORD,
      },
    });

    const mailOptions = {
      from: process.env.EMAIL_USER,
      to: booking.email || process.env.BARBER_EMAIL,
      subject: "Programare AnulatƒÉ - Barber Shop",
      html: `
        <div style="font-family: Arial, sans-serif; max-width: 600px; margin: 0 auto;">
          <h2 style="color: #d32f2f;">Programare AnulatƒÉ</h2>
          <p>Salut ${booking.name},</p>
          <p>Programarea ta pentru <strong>${
            booking.service
          }</strong> din data de <strong>${booking.date} la ${
        booking.time
      }</strong> a fost anulatƒÉ.</p>
          
          ${reason ? `<p><strong>Motiv:</strong> ${reason}</p>` : ""}
          
          <p>Pentru a face o nouƒÉ programare, te rugƒÉm sƒÉ vizitezi site-ul nostru.</p>
          
          <p>Mul»õumim pentru √Æn»õelegere!</p>
          <p>Echipa Barber Shop</p>
        </div>
      `,
    };

    await transporter.sendMail(mailOptions);
  } catch (error) {
    console.error("Error sending cancellation email:", error);
    throw error;
  }
}
